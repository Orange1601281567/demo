<!DOCTYPE html>
<html xmlns:th="http://www.springframework.org/schema/jdbc">
<head>
    <meta charset="utf-8" />
    <title>Orange</title>
    <link rel="stylesheet" href="layui/css/layui.css">

</head>

<body class="layui-layout-body">

<!--<div class="layui-layout layui-layout-admin">-->
<!--    <div class="layui-header">-->
<!--        <a href="">-->
<!--            <div class="layui-logo">后台管理系统</div>-->
<!--        </a>-->
<!--        <ul class="layui-nav layui-layout-right">-->
<!--            <li class="layui-nav-item">-->
<!--                <a href="javascript:;">-->
<!--                    <img src="https://gitee.com/uploads/66/890966_Leytton.png?1512991922" class="layui-nav-img"> Leytton </a>-->
<!--                <dl class="layui-nav-child">-->
<!--                    <dd>-->
<!--                        <a href="javascript:;" onclick="addTab(this);" tab_url="http://www.llqqww.com">基本资料</a>-->
<!--                    </dd>-->
<!--                    <dd>-->
<!--                        <a href="">安全设置</a>-->
<!--                    </dd>-->
<!--                </dl>-->
<!--            </li>-->
<!--            <li class="layui-nav-item">-->
<!--                <a href="/mp.php/login/logout">退了</a>-->
<!--            </li>-->
<!--        </ul>-->
<!--    </div>-->
<!--    <div class="layui-side layui-bg-black">-->
<!--        <div class="layui-side-scroll">-->
<!--            &lt;!&ndash; 左侧导航区域（可配合layui已有的垂直导航） &ndash;&gt;-->
<!--            <ul class="layui-nav layui-nav-tree">-->
<!--                <li class="layui-nav-item layui-nav-itemed">-->
<!--                    <a class="" href="javascript:;">基本信息</a>-->
<!--                    <dl class="layui-nav-child">-->
<!--                        <dd class="layui-this">-->
<!--                            <a href="javascript:;" >基本信息</a>-->
<!--                        </dd>-->
<!--                    </dl>-->
<!--                </li>-->
<!--                <li class="layui-nav-item layui-nav-itemed">-->
<!--                    <a href="javascript:;">开源作品</a>-->
<!--                    <dl class="layui-nav-child">-->
<!--                        <dd>-->
<!--                            <a href="javascript:;" class="layTabPlus" tab_url="https://gitee.com/Leytton/ThinkJD">-->
<!--                                <i class="layui-icon layui-icon-star"> </i>-->
<!--                                ThinJDBC-->
<!--                            </a>-->
<!--                        </dd>-->
<!--                        <dd>-->
<!--                            <a href="javascript:;" class="layTabPlus" tab_url="https://gitee.com/Leytton/SimJQ">SimJQ</a>-->
<!--                        </dd>-->
<!--                        <dd>-->
<!--                            <a href="javascript:;" class="layTabPlus" tab_url="https://gitee.com/Leytton/layTabPlus" tab_jump="true">layTabPlus</a>-->
<!--                        </dd>-->
<!--                    </dl>-->
<!--                </li>-->
<!--                <li class="layui-nav-item layui-nav-itemed">-->
<!--                    <a href="javascript:;">关于作者</a>-->
<!--                    <dl class="layui-nav-child">-->
<!--                        <dd><a href="javascript:void(0);" class="layTabPlus" th:tab_url="@{/index}">网站</a></dd>-->
<!--                        <dd><a href="javascript:void(0);" class="layTabPlus" tab_url="https://blog.csdn.net/leytton">博客</a></dd>-->
<!--                    </dl>-->
<!--                </li>-->
<!--                <li class="layui-nav-item">-->
<!--                    <a href="javascript:;">其它</a>-->
<!--                    <dl class="layui-nav-child">-->
<!--                        <dd><a href="javascript:void(0);" class="layTabPlus" tab_url="http://www.llqqww.com">网站</a></dd>-->
<!--                        <dd><a href="javascript:void(0);" class="layTabPlus" tab_url="https://blog.csdn.net/leytton">博客</a></dd>-->
<!--                    </dl>-->
<!--                </li>-->
<!--                <li class="layui-nav-item">-->
<!--                    <a href="javascript:void(0);" class="layTabPlus" tab_url="https://blog.csdn.net/leytton">CSDN</a>-->
<!--                </li>-->
<!--            </ul>-->
<!--        </div>-->
<!--    </div>-->

<!--    <div class="layui-body">-->
<!--        &lt;!&ndash; 内容主体区域 &ndash;&gt;-->
<!--        <div class="layui-tab" lay-filter="demoTab" lay-allowClose="true">-->
<!--            <ul class="layui-tab-title">-->
<!--                <li class="layui-this noclose" lay-id='base_info'>基本信息</li>-->
<!--            </ul>-->
<!--            <div class="layui-tab-content" style="padding:0px;">-->
<!--                <div class="layui-tab-item layui-show">-->
<!--                    <div class="sysNotice col">-->
<!--                        <blockquote class="layui-elem-quote title">基本信息</blockquote>-->
<!--                        <table class="layui-table">-->
<!--                            <tbody>-->
<!--                            <tr>-->
<!--                                <td>当前版本</td>-->
<!--                                <td class="version">V1.2</td>-->
<!--                            </tr>-->
<!--                            <tr>-->
<!--                                <td>开发作者</td>-->
<!--                                <td class="author">Leytton</td>-->
<!--                            </tr>-->
<!--                            <tr>-->
<!--                                <td>项目首页</td>-->
<!--                                <td class="homePage"><a href="https://gitee.com/Leytton/layTabPlus">https://gitee.com/Leytton/layTabPlus</a></td>-->
<!--                            </tr>-->
<!--                            <tr>-->
<!--                                <td colspan="2">-->
<!--                                    <script src='https://gitee.com/Leytton/layTabPlus/widget_preview'></script>-->
<!--                                    <style>-->
<!--                                        .pro_name a{color: #4183c4;}-->
<!--                                        .osc_git_title{background-color: #fff;}-->
<!--                                        .osc_git_box{background-color: #fff;}-->
<!--                                        .osc_git_box{border-color: #E3E9ED;}-->
<!--                                        .osc_git_info{color: #666;}-->
<!--                                        .osc_git_main a{color: #9B9B9B;}-->
<!--                                    </style>-->
<!--                                </td>-->
<!--                            </tr>-->
<!--                            </tbody>-->
<!--                        </table>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--    <div class="layui-footer">-->
<!--        © 2018 <a href="https://gitee.com/Leytton/layTabPlus">layTabPlus</a> - by Leytton-->
<!--    </div>-->
<!--</div>-->




<div class="layui-side layui-bg-black">
    <div class="layui-side-scroll">
        <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
        <ul class="layui-nav layui-nav-tree" lay-filter="test" id="memus">
        </ul>
    </div>
</div>
<div class="layui-body">
    <!-- 动态选项卡 -->
    <div id="tabzu" class="layui-tab layui-tab-card layui-tab-brief" lay-filter="tabDemo" lay-allowclose="true">
        <ul class="layui-tab-title"></ul>
        <div class="layui-tab-content"></div>
    </div>
</div>




</body>
<script type="text/javascript"  th:src="@{/layui/layui.all.js}"></script>
<script>
    var $ = layui.jquery;
    var layer = layui.layer;
    var element = layui.element;
    var util = layui.util;
    var table = layui.table;
</script>
<script type="text/javascript"  th:src="@{/js/layTabPlus.js}"></script>
<script>
    var ctx = [[@{/}]];
</script>
<script>
    layTabPlus.init({
        lay_filter: 'demoTab'
    });

    prefix=ctx;
    layui.use('element', function() {
        function checkLastItem(arr, i) {
            return arr.length == (i + 1);
        }

        function getAhtml(obj){
            return  "<a href=\"javascript:;\"onclick=\"addTab('" + obj.title + "','" + obj.href + "')\" >" + obj.title + "</a>";
        }
        //动态菜单
        layui.jquery.ajax({
            url: prefix+'/Menu/list',
            method: 'GET',
            success: function(res) {
                var html = "";
                for(var i = 0; i < res.length; i++) {
                    if (res[i].href =='#'){
                        var strli ="<li class=\"layui-nav-item lay-unselect \" >";
                        strli = strli + "<a href=\"javascript:;\">" + res[i].title + "</a>";
                        for(var m=0;m<res.length;m++) {
                            if(res[m].parentId==res[i].id){
                                strli = strli + "<dl class=\"layui-nav-child\" >";
                                strli = strli + "<dd>"+getAhtml(res[m])+"</dd>";
                                strli = strli + "</dl>";
                            }
                        }
                        strli = strli + "</li>";
                        html = html + strli;
                    }
                }
                layui.jquery("#memus").html(html);
                layui.element.init(); //一定初始化一次
            }
        })
    });

    //添加选项卡
    function addTab(name, url) {
        console.log("contentTxt");
        if (layui.jquery(".layui-tab-title li[lay-id='" + name + "']").length > 0) {
            //选项卡已经存在
            layui.element.tabChange('tabDemo', name);
            layer.msg('切换-' + name)
        } else {
            //动态控制iframe高度
            var tabheight = layui.jquery(window).height() - 95;
            contentTxt = '<iframe src="'+prefix+url+'" scrolling="no" width="100%" height="' + (tabheight) + 'PX"></iframe>';
            console.log(contentTxt);
            //新增一个Tab项
            layui.element.tabAdd('tabDemo', {
                title: name,
                content: contentTxt,
                id: name
            })
            //切换刷新
            layui.element.tabChange('tabDemo', name)
            layer.msg('新增-' + name)
        }
    }



    //加载动态菜单
    layui.use('element', function() {
        function checkLastItem(arr, i) {
            return arr.length == (i + 1);
        }

        function getAhtml(obj){
            return  "<a href=\"javascript:;\"onclick=\"addTab('" + obj.title + "','" + obj.href + "')\" >" + obj.title + "</a>";
        }
        //动态菜单
        layui.jquery.ajax({
            url: prefix+'/Menu/list',
            method: 'GET',
            data:{role:1},
            success: function(res) {
                var html = "";
                for(var i = 0; i < res.length; i++) {
                    if (res[i].href =='#'){
                        var strli ="<li class=\"layui-nav-item lay-unselect \" >";
                        if(res[i].role!=null&&res[i].role!="")
                            var strli="<shiro:hasRole name='"+res[i].role+"'>"+"<li class=\"layui-nav-item lay-unselect \" >";
                        strli = strli + "<a href=\"javascript:;\">" + res[i].title + "</a>";
                        for(var m=0;m<res.length;m++) {
                            if(res[m].parentId==res[i].id){
                                strli = strli + "<dl class=\"layui-nav-child\" >";
                                strli = strli + "<dd>"+getAhtml(res[m])+"</dd>";
                                strli = strli + "</dl>";
                            }
                        }
                        strli = strli + "</li>";
                        if(res[i].role!=null&&res[i].role!="")
                            strli=strli+"</shiro:hasRole>";
                        html = html + strli;
                    }
                }
                layui.jquery("#memus").html(html);
                layui.element.init(); //一定初始化一次
            }
        })
    });

    //添加选项卡
    function addTab(name, url) {
        if (layui.jquery(".layui-tab-title li[lay-id='" + name + "']").length > 0) {
            //选项卡已经存在
            layui.element.tabChange('tabDemo', name);
        } else {
            //动态控制iframe高度
            var tabheight = layui.jquery(window).height();
            contentTxt = '<iframe src="'+prefix+url+'" scrolling="no" width="100%" height="' + (tabheight) + 'PX" frameborder=”no” border=”0″ marginwidth=”0″ marginheight=”0″ allowtransparency=”yes”></iframe>';
            //新增一个Tab项
            layui.element.tabAdd('tabDemo', {
                title: name,
                content: contentTxt,
                id: name
            })
            //切换刷新
            layui.element.tabChange('tabDemo', name)
        }
    }




</script>
</html>
<style>
    .sysNotice .layui-table {
        margin-top: 0;
        border-left: 5px solid #e2e2e2;
    }

    .layui-elem-quote.title {
        padding: 10px 15px;
        margin-bottom: 0;
    }

    .sysNotice {
        width: 75%;
    }
    .code{
        color: #c7254e;
        background-color: #f9f2f4;
        border-radius: 2px;
        padding: 4px 2px 0;
    }
</style>